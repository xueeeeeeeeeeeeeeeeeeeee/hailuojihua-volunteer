(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-hailuochat-hailuochat"],{3380:function(t,e,n){"use strict";n.r(e);var i=n("ea3e"),a=n("f6a5");for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("af94");var s=n("f0c5"),c=Object(s["a"])(a["default"],i["b"],i["c"],!1,null,"7ae3e8a1",null,!1,i["a"],void 0);e["default"]=c.exports},"36ba":function(t,e,n){t.exports=n.p+"static/img/hailuo.85641d52.png"},af94:function(t,e,n){"use strict";var i=n("f1fb"),a=n.n(i);a.a},bdc3:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.content[data-v-7ae3e8a1]{height:%?1437?%;width:100%;display:flex;justify-content:center;align-items:center;position:relative}.content .background[data-v-7ae3e8a1]{position:absolute;height:%?1437?%;width:100%}.content .chat[data-v-7ae3e8a1]{position:relative;margin-top:%?-200?%;width:%?680?%;height:%?1150?%;background:hsla(0,0%,100%,.7);z-index:4;border-radius:%?30?%;border-top:%?8?% #7692ca solid;border-bottom:%?8?% #7692ca solid;box-sizing:border-box;display:flex;flex-direction:column;align-items:center}.content .chat .chatname[data-v-7ae3e8a1]{display:flex;justify-content:center;align-items:center;height:%?50?%;line-height:%?50?%;width:100%;border-bottom:%?1?% solid #000}.content .chat .allchat[data-v-7ae3e8a1]{display:flex;height:%?1000?%;justify-content:center;align-items:center}.content .chat .allchat .chatitem1[data-v-7ae3e8a1]{position:relative;white-space:normal;word-break:break-all;overflow:hidden;font-weight:bolder;box-sizing:border-box;padding-left:%?15?%;padding-top:%?8?%;margin-top:%?20?%;min-height:%?100?%;margin-left:%?20?%;height:auto;width:%?500?%;background:#fceec1;border-radius:%?20?% %?20?% %?20?% %?0?%}.content .chat .allchat .chatitem1 .time[data-v-7ae3e8a1]{bottom:%?10?%;right:%?10?%;position:absolute;font-weight:100;font-size:%?5?%}.content .chat .allchat .chatitem2[data-v-7ae3e8a1]{-webkit-transform:translateX(%?140?%);transform:translateX(%?140?%);position:relative;white-space:normal;word-break:break-all;overflow:hidden;font-weight:bolder;box-sizing:border-box;padding-left:%?15?%;padding-top:%?8?%;margin-top:%?20?%;min-height:%?100?%;margin-left:%?20?%;height:auto;width:%?500?%;background:#de7241;border-radius:%?20?% %?20?% %?0?% %?20?%}.content .chat .allchat .chatitem2 .time[data-v-7ae3e8a1]{bottom:%?10?%;right:%?10?%;position:absolute;font-weight:100;font-size:%?5?%}.content .chat .input[data-v-7ae3e8a1]{width:%?800?%;height:%?60?%;position:absolute;bottom:%?10?%;left:%?20?%;display:flex;box-sizing:border-box}.content .chat uni-input[data-v-7ae3e8a1]{width:%?500?%;border-radius:%?25?%;border:%?1?% #333 solid;height:%?60?%;padding-left:%?20?%;border-radius:%?25?%;box-sizing:border-box}.content .chat uni-image[data-v-7ae3e8a1]{float:right;width:%?100?%;height:%?80?%;margin-left:%?50?%}.content .chat .inputting[data-v-7ae3e8a1]{display:flex;justify-content:center;align-items:center;float:right;width:%?100?%;border-radius:%?30?%;height:%?60?%;margin-left:%?10?%;line-height:%?60?%;color:#fff;background:#084da6}.content .all .user[data-v-7ae3e8a1]{height:%?150?%;width:%?150?%;background:#333;border-radius:50%;position:fixed;bottom:%?130?%;right:%?20?%;z-index:1}.content .all .user uni-image[data-v-7ae3e8a1]{height:%?150?%;width:%?150?%;border-radius:50%}',""]),t.exports=e},c3c8:function(t,e,n){t.exports=n.p+"static/img/backgroundmain.828efa36.jpg"},cb07:function(t,e,n){"use strict";n("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("e9c4");var i={data:function(){return{token:"",hailuoid:1,scrollTop:"",change:"user2",user:{id:10002,userstate:0,headpicurl:"../../static/user/headpic.jpg"},chatname:"",totle:10,chatcontent:[],infodata:null,bubbleinput:"",bubbleword:"",inputting:0,test:{code:605,hailuo_id:31,content:"你好",time:"25:12"},ws:null,timer:null}},watch:{bubbleinput:function(t,e){""==t?(console.log(1),this.inputting=0):this.inputting=1}},onLoad:function(t){this.token=uni.getStorageSync("token");var e=this;this.hailuoid=t.id,console.log(t),this.gethailuodetail(),this.timer=setInterval((function(){e.gethailuodetail()}),1e4),console.log(this.timer)},onShow:function(){this.returninfo(),this.gethailuodetail()},onLaunch:function(){uni.connectSocket({url:"ws://124.220.40.115:82/chat/2",success:function(t){console.log(t)}}),uni.onSocketMessage((function(t){console.log("收到服务器内容："+t.data)}))},methods:{createconnect:function(){},gethailuodetail:function(){var t=this;console.log(this.hailuoid),uni.request({url:"http://124.220.40.115:82/hailuo/readOne",method:"POST",data:{Authorization:this.token,hailuo_id:this.hailuoid,read:1},header:{Authorization:this.token,"content-type":"application/json;charset=UTF-8"},success:function(e){201==e.data.code&&uni.navigateTo({url:"/pages/login/login"}),t.chatcontent=e.data.data.chatLog,t.chatname=e.data.data.children_username,t.$nextTick((function(){this.scrollTop="msg"+String(this.chatcontent.length-1)}))},fail:function(t){console.log(2),console.log(t.data)}})},returninfo:function(){var t=this;uni.request({url:"http://124.220.40.115:82/user/get_info",method:"POST",header:{Authorization:this.token,"content-type":"application/json;charset=UTF-8"},success:function(e){var n=t;201==e.data.code&&uni.navigateTo({url:"/pages/login/login"}),t.user.headpicurl="http://124.220.40.115:82/uploadFile/"+e.data.data.id+".jpg",console.log(e.data),t.userinfo=e.data.data,console.log(t.userinfo),uni.connectSocket({url:"ws://124.220.40.115:82/chat/"+t.userinfo.id,success:function(t){console.log(t)}});var i=t.hailuoid;console.log(i),uni.onSocketOpen((function(t){console.log("WebSocket连接已打开！"),1})),uni.onSocketError((function(t){console.log("WebSocket连接打开失败，请检查！")})),uni.onSocketMessage((function(t){clearInterval(n.timer),n.timer=setInterval((function(){n.gethailuodetail()}),1e4),console.log("收到服务器内容："+t.data),this.WebSocketstaut=1,console.log(JSON.parse(t.data).hailuo_id),console.log(i),JSON.parse(t.data).hailuo_id==i&&n.gethailuodetail(),console.log(this.WebSocketstaut)}))},fail:function(t){console.log(2),console.log(t.data)}})},changeing:function(){this.inputting=1},oninput:function(t){this.bubbleinput=t.detail.value},lose:function(){""==this.bubbleinput&&(this.inputting=0)},send:function(){var t=this,e=this;uni.request({url:"http://124.220.40.115:82/hailuo/reply_hailuo",method:"POST",data:{hailuo_id:this.hailuoid,content:this.bubbleinput},header:{Authorization:this.token,"content-type":"application/json;charset=UTF-8"},success:function(n){console.log(n),201==n.data.code?uni.navigateTo({url:"/pages/login/login"}):"回复成功"==n.data.msg&&(uni.sendSocketMessage({data:JSON.stringify({code:605,hailuo_id:t.hailuoid,content:t.bubbleinput,time:""}),success:function(){console.log(11)}}),uni.showToast({title:"回复成功",icon:"exception",duration:500}),e.gethailuodetail())},fail:function(t){console.log(2),console.log(t.data)}}),this.bubbleinput="",1==this.chatcontent.length&&setTimeout((function(){t.$router.go(0)}),500)}}};e.default=i},ea3e:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"content"},[i("v-uni-image",{staticClass:"background",attrs:{"lazy-load":!0,src:n("c3c8"),mode:"aspectFill"}}),i("v-uni-view",{staticClass:"chat"},[i("p",{staticClass:"chatname"},[t._v(t._s(t.chatname))]),i("v-uni-scroll-view",{staticClass:"allchat",attrs:{"scroll-y":"true","scroll-into-view":t.scrollTop}},t._l(t.chatcontent,(function(e,n){return"儿童"==e.identity?i("v-uni-view",{staticClass:" chatitem1",attrs:{id:"msg"+n}},[t._v(t._s(e.content)),i("v-uni-view",{staticClass:"time"},[t._v(t._s(e.sendTime))])],1):i("v-uni-view",{staticClass:"chatitem2",attrs:{id:"msg"+n}},[t._v(t._s(e.content)),i("v-uni-view",{staticClass:"time"},[t._v(t._s(e.sendTime))])],1)})),1),i("v-uni-view",{staticClass:"input",attrs:{"adjust-position":!0}},[i("v-uni-input",{staticClass:"uni-input",attrs:{focus:!0,placeholder:"请输入...",value:t.bubbleinput},on:{focus:function(e){arguments[0]=e=t.$handleEvent(e),t.changeing.apply(void 0,arguments)},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.lose.apply(void 0,arguments)},input:function(e){arguments[0]=e=t.$handleEvent(e),t.oninput.apply(void 0,arguments)}}}),0==t.inputting?i("v-uni-image",{attrs:{src:n("36ba"),mode:"aspectFill"}}):i("v-uni-view",{staticClass:"inputting",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.send.apply(void 0,arguments)}}},[t._v("发送")])],1)],1),i("v-uni-view",{staticClass:"all"},[i("v-uni-view",{staticClass:"user"},[i("v-uni-image",{attrs:{src:t.user.headpicurl,mode:"aspectFill"}})],1)],1)],1)},a=[]},f1fb:function(t,e,n){var i=n("bdc3");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("4f06").default;a("7bd9a604",i,!0,{sourceMap:!1,shadowMode:!1})},f6a5:function(t,e,n){"use strict";n.r(e);var i=n("cb07"),a=n.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a}}]);